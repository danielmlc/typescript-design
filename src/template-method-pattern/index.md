# æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method Pattern)

## æ„å›¾

**æ¨¡æ¿æ–¹æ³•æ¨¡å¼**æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤çš„å®ç°å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥åœ¨ä¸æ”¹å˜ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚

## ç»“æ„

```mermaid
classDiagram
    class CaffeineBeverage {
        <<Abstract>>
        +prepareRecipe()
        -boilWater()
        -pourInCup()
        #brew()*
        #addCondiments()*
    }

    class Tea {
        #brew()
        #addCondiments()
    }

    class Coffee {
        #brew()
        #addCondiments()
    }

    CaffeineBeverage <|-- Tea
    CaffeineBeverage <|-- Coffee
```

## åœºæ™¯ï¼šæ˜Ÿå·´å…‹å®ä¹ ç”Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åˆšå»æ˜Ÿå·´å…‹å½“å®ä¹ ç”Ÿã€‚åº—é•¿ç»™ä½ ä¸€å¼ **SOPï¼ˆæ ‡å‡†ä½œä¸šç¨‹åºï¼‰**ï¼Œä¸Šé¢å†™ç€åˆ¶ä½œçƒ­é¥®çš„ 4 ä¸ªæ­¥éª¤ï¼š

1.  æŠŠæ°´çƒ§å¼€ï¼ˆæ‰€æœ‰é¥®æ–™éƒ½ä¸€æ ·ï¼‰ã€‚
2.  **ç”¨æ²¸æ°´å†²æ³¡åŸæ–™**ï¼ˆè¿™ä¸€æ­¥çœ‹ä½ æ˜¯åšèŒ¶è¿˜æ˜¯åšå’–å•¡ï¼‰ã€‚
3.  æŠŠé¥®æ–™å€’è¿›æ¯å­ï¼ˆæ‰€æœ‰é¥®æ–™éƒ½ä¸€æ ·ï¼‰ã€‚
4.  **åŠ è°ƒæ–™**ï¼ˆèŒ¶åŠ æŸ æª¬ï¼Œå’–å•¡åŠ ç³–å¥¶ï¼‰ã€‚

ğŸ’¡ **æ¨¡æ¿æ–¹æ³•æ¨¡å¼**ï¼š
è¿™å¼  SOP å°±æ˜¯ä¸€ä¸ª**æ¨¡æ¿ï¼ˆTemplateï¼‰**ã€‚
*   å®ƒè§„å®šäº†æµç¨‹çš„**éª¨æ¶**ï¼ˆå…ˆçƒ§æ°´ï¼Œå†å†²æ³¡ï¼Œå†å€’æ¯ï¼Œæœ€ååŠ æ–™ï¼‰ã€‚
*   å®ƒæŠŠ**ä¸å˜çš„æ­¥éª¤**ï¼ˆçƒ§æ°´ã€å€’æ¯ï¼‰ç›´æ¥å†™æ­»äº†ã€‚
*   å®ƒæŠŠ**å˜åŒ–çš„æ­¥éª¤**ï¼ˆå†²æ³¡ã€åŠ æ–™ï¼‰ç•™ç©ºï¼Œè®©ä½ æ ¹æ®å…·ä½“æƒ…å†µå»å¡«ç©ºã€‚

åœ¨ä»£ç ä¸­ï¼š
*   `CaffeineBeverage` ç±»å°±æ˜¯é‚£å¼  SOPã€‚`prepareRecipe()` æ–¹æ³•å°±æ˜¯é‚£ä¸ªé›·æ‰“ä¸åŠ¨çš„æµç¨‹ã€‚
*   `Tea` å’Œ `Coffee` ç±»å°±æ˜¯å…·ä½“çš„æ‰§è¡Œè€…ï¼Œå®ƒä»¬åªéœ€è¦è´Ÿè´£å¡«å¥½â€œå†²æ³¡â€å’Œâ€œåŠ æ–™â€è¿™ä¸¤ä¸ªç©ºå°±è¡Œäº†ï¼Œä¸ç”¨æ“å¿ƒæ•´ä¸ªæµç¨‹æ€ä¹ˆè·‘ã€‚

## ä»£ç è§£æ

1.  **æŠ½è±¡ç±» (Abstract Class)**: (`CaffeineBeverage` ç±»)
    *   è¿™æ˜¯æ¨¡æ¿çš„æ ¸å¿ƒã€‚å®ƒæ‹¥æœ‰ä¸€ä¸ª `prepareRecipe` æ–¹æ³•ï¼Œåƒå¯¼æ¼”ä¸€æ ·æ§åˆ¶ç€æ•´ä¸ªæµç¨‹ã€‚
    *   å®ƒè¿˜å®šä¹‰äº†ä¸€äº›æŠ½è±¡æ–¹æ³•ï¼ˆ`brew`, `addCondiments`ï¼‰ï¼Œå¼ºåˆ¶å­ç±»å¿…é¡»å»å®ç°ã€‚
    ```typescript
    // src/template-method-pattern/caffeine-beverage.ts
    export abstract class CaffeineBeverage {
        // æ¨¡æ¿æ–¹æ³•ï¼šå®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼Œä¸”é€šå¸¸æ˜¯ final çš„ï¼ˆä¸è®©å­ç±»è¦†ç›–ï¼‰
        public prepareRecipe(): void {
            this.boilWater();
            this.brew(); // å…³é”®ç‚¹ï¼šè°ƒç”¨æŠ½è±¡æ–¹æ³•ï¼Œæ¨è¿Ÿåˆ°å­ç±»å®ç°
            this.pourInCup();
            this.addCondiments(); // å…³é”®ç‚¹ï¼šè°ƒç”¨æŠ½è±¡æ–¹æ³•
        }

        // å…·ä½“æ–¹æ³•ï¼šæ‰€æœ‰å­ç±»é€šç”¨çš„é€»è¾‘
        private boilWater(): void { console.log("Boiling water"); }
        private pourInCup(): void { console.log("Pouring into cup"); }

        // æŠ½è±¡æ–¹æ³•ï¼šç•™ç»™å­ç±»å»å¡«çš„ç©º
        protected abstract brew(): void;
        protected abstract addCondiments(): void;
    }
    ```

2.  **å…·ä½“ç±» (Concrete Class)**: (`Tea`, `Coffee` ç±»)
    *   å®ƒä»¬åªéœ€è¦å…³æ³¨è‡ªå·±ç‹¬ç‰¹çš„é€»è¾‘ã€‚
    ```typescript
    // src/template-method-pattern/tea.ts
    export class Tea extends CaffeineBeverage {
        // èŒ¶å¶æ€ä¹ˆæ³¡ï¼Ÿ
        protected brew(): void {
            console.log("Steeping the tea");
        }
        // èŒ¶åŠ ä»€ä¹ˆæ–™ï¼Ÿ
        protected addCondiments(): void {
            console.log("Adding Lemon");
        }
    }
    ```

## ä¼˜ç‚¹

*   **ä»£ç å¤ç”¨**: å°†ç®—æ³•ä¸­ä¸å˜çš„éƒ¨åˆ†æå–åˆ°çˆ¶ç±»ä¸­ï¼Œé¿å…äº†ä»£ç é‡å¤ã€‚
*   **å¼€é—­åŸåˆ™**: ä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹ç°æœ‰ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå¼•å…¥æ–°çš„å­ç±»æ¥å®ç°ç®—æ³•ä¸­çš„å¯å˜éƒ¨åˆ†ã€‚
*   **æ§åˆ¶åè½¬ (Inversion of Control)**: çˆ¶ç±»è°ƒç”¨å­ç±»çš„æ“ä½œï¼Œè€Œä¸æ˜¯ç›¸åã€‚è¿™æ˜¯ä¸€ç§è¢«ç§°ä¸ºâ€œå¥½è±ååŸåˆ™â€ï¼ˆâ€œä¸è¦æ¥æ‰¾æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šæ¥æ‰¾ä½ â€ï¼‰çš„ä½“ç°ã€‚

## å¦‚ä½•è¿è¡Œç¤ºä¾‹

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œè¿™ä¸ª TypeScript ç¤ºä¾‹ï¼š

```bash
npx ts-node src/template-method-pattern/index.ts
```